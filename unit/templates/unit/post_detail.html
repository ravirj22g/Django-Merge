{% extends 'unit/base.html' %}
{% load static %}
{% block content %}
    <article class="post">
        <aside class="actions">
            {% if request.user.is_authenticated  %}
            <a class="btn btn-secondary" href="{% url 'post_edit' pk=post.pk %}">
                <i class="fa fa-pencil" style="font-size:24px"></i>

             </a>
            {% endif %}
         </aside>
        {% if post.published_date %}
            <time class="date">
                {{ post.published_date }}
            </time>
        {% endif %}

        <h2>
            {% if post.thumbnail_image %}
            <img src="{{post.thumbnail_image.url}}" alt="thumnial_image" width="50" height="50" style="border-radius: 50%"/>
            {% endif %}
            {{ post.title }}
            
        </h2>
        {% if post.tag %} Tag:
        {% for tag in post.tag.all %}
            <a href="{% url 'tag_detail' id=tag.id %}">{{tag}},</a>
       {% endfor %}
       {% endif %}
        {% if post.featured_image %}
        <img src="{{post.featured_image.url}}" alt="featured_image" width="100%" height="400"/>
        {% endif %}

        <p>{{ post.text|linebreaksbr }}</p>
    </article>

    {% comment %} {% for comment in comments %} {% if comment %}

    <p>{{comment.name}}:</p>
    <p>{{comment.comment|linebreaks}}</p> {% endcomment %}
    
<h2>Leave a Comment</h2>
<form method="POST" enctype="multitype/form-data" class="post-form">
  {% csrf_token %} {{form.as_p}}
  <div class="text-center">
    <button type="submit" class="save btn btn-secondary text-center">
      Submit
    </button>
  </div>
</form>

{% for comment in comments %} {% if comment %}

<p>{{comment.name}}:</p>
<p>{{comment.comment|linebreaks}}</p> 
{% for reply in comment.replies.all %}
<div class="bg-info ms-5 p-3 border-1 rounded mb-3">
  <p>{{reply.name}}</p>
  <p>{{reply.comment}}</p>
</div>
{% endfor %}
<h5 class="ms-5 p-3">Reply</h5>
<form action="" method="post">
  {% csrf_token %}
  <div class="ms-5 p-3">
    {{form.as_p}}
    <input type="hidden" name="reply_id" value="{{comment.id}}" />
    <input class="btn btn-primary" type="submit" value="Reply" />
  </div>
</form>
{% else %}
<h4>There are no comments</h4>
{% endif %} {% endfor %} {% endblock %}
